"use strict";(self["webpackChunkv3"]=self["webpackChunkv3"]||[]).push([[8017],{6120:function(t,e,r){r.d(e,{Z:function(){return p}});var i=r(6252),a=r(9963),s=r(3577);const n=(0,i._)("img",{style:{"max-height":"100px",height:"100%"},src:"https://cdn.glitch.com/6c14ca82-3bcb-4fd6-afa7-815b95e04a14%2Fras-run-slow.gif?v=1632241290215"},null,-1),o={style:{"font-size":"32px",color:"white","text-shadow":"0px 0px 3px grey, 0 0 10px black, 0 0 10px black","line-height":"30px","padding-top":"12px","margin-left":"20px"}};function l(t,e,r,l,c,u){return(0,i.wg)(),(0,i.iD)("div",{class:"noselect loading-part animatefade absolute",onContextmenu:e[0]||(e[0]=(0,a.iM)((()=>{}),["prevent"]))},[n,(0,i._)("div",o,(0,s.zw)(r.text),1)],32)}var c={props:{text:{type:String,default:""}}},u=r(3744);const d=(0,u.Z)(c,[["render",l]]);var p=d},2404:function(t,e,r){r.r(e),r.d(e,{default:function(){return L}});var i=r(6252),a=r(9963);const s=(0,i._)("h2",null,"Artifacts",-1),n=["src"],o=["src"];function l(t,e,r,l,c,u){const d=(0,i.up)("PagePath"),p=(0,i.up)("PageTitle"),m=(0,i.up)("FilterBlock"),f=(0,i.up)("ArtifactFullImage"),h=(0,i.up)("MouseParallax"),g=(0,i.up)("router-link"),y=(0,i.up)("FetchComponent"),w=(0,i.up)("ListArtifactImages");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i.Wm)(d),s])),_:1}),(0,i.Wm)(m,{modelValue:c.filters,"onUpdate:modelValue":e[0]||(e[0]=t=>c.filters=t),"one-stars":!0,"two-stars":!0,"common-role":!0,class:"pad-5"},null,8,["modelValue"]),(0,i.Wm)(w,{class:"flex flex-wrap justify-center",style:{"min-height":"100vh"}},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{promise:c.fetching,onLoad:u.fetchComplete,onFinally:u.afterFetch},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(u.sortedList,(t=>(0,i.wy)(((0,i.wg)(),(0,i.j4)(g,{key:t,to:"/artifacts/"+t._id,class:"route-restore pointer",style:{"vertical-align":"top"}},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{class:"pad-5","border-radius":"0.08em"},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{artifact:t},null,8,["artifact"]),t.$isNew?((0,i.wg)(),(0,i.iD)("img",{key:0,style:{position:"absolute",top:"0",left:"0",width:"25%"},src:u.newIcon},null,8,n)):t.$isUpdated?((0,i.wg)(),(0,i.iD)("img",{key:1,style:{position:"absolute",top:"0",left:"0",width:"25%"},src:u.updatedIcon},null,8,o)):(0,i.kq)("",!0)])),_:2},1024)])),_:2},1032,["to"])),[[a.F8,u.filtredList[t._id]]]))),128))])),_:1},8,["promise","onLoad","onFinally"])])),_:1})])}var c=r(8753),u=r(171),d=r(222),p=r(3409),m=r(9367),f=r(5123),h=r(3355);const g=(0,i._)("div",null,"Error",-1);function y(t,e,r,a,s,n){const o=(0,i.up)("LoadingComponent");return s.isFetching?(0,i.WI)(t.$slots,"fetching",{key:0},(()=>[(0,i.Wm)(o,{text:r.text},null,8,["text"])])):s.isError?(0,i.WI)(t.$slots,"error",{key:1},(()=>[g])):(0,i.WI)(t.$slots,"default",{key:2})}var w=r(6120),x={emits:["load","error","finally"],components:{LoadingComponent:w.Z},props:{promise:{type:Array,default:()=>[]},text:{type:String,default:"CONNECTING"}},data(){return{isFetching:!1,isError:!1,isDone:!1}},watch:{promise:{immediate:!0,handler(){this.doPromise()}}},methods:{doPromise(){this.isFetching=!0;let t=Array.isArray(this.promise)?this.promise:[this.promise];Promise.all(t).then((t=>{this.$emit("load",...t)})).catch((t=>{this.isError=!0,this.$emit("error",t)})).then((()=>{this.isFetching=!1,this.$emit("finally")}))}}},v=r(3744);const k=(0,v.Z)(x,[["render",y]]);var C=k,b=null,_=0,F={name:"ArtifactsIndex",components:{PagePath:u.Z,PageTitle:d.Z,FilterBlock:p.Z,ListArtifactImages:m.Z,MouseParallax:f.Z,ArtifactFullImage:h.Z,FetchComponent:C},inject:["mainContainerWrapper"],data(){return{fetching:null,filters:{name:"",rarity:[],role:[],tags:[],debuff:[],buff:[],common:[]},list:[]}},created(){this.fetching=this.$gameData.artifact.list(),b&&(this.filters=JSON.parse(b))},beforeUnmount(){b=JSON.stringify(this.filters),this.mainContainerWrapper&&(_=this.mainContainerWrapper().scrollTop)},computed:{newIcon(){return c.cK+"/img/gacha_new.png"},updatedIcon(){return c.cK+"/ui/cm_update_icon.png"},sortedList(){const t=t=>["warrior","knight","assassin","ranger","mage","manauser"].indexOf(t),e=Array.isArray(this.list)?this.list.slice():Object.values(this.list);return e.sort(((t,e)=>t.name<e.name?-1:0)).sort(((e,r)=>e.$isNew||e.$isUpdated?-1:e.rarity!==r.rarity?e.rarity>r.rarity?-1:1:t(e.role)<t(r.role)?-1:1))},filtredList(){var t={},e=/[^a-z0-9]/g,r=/[^a-z0-9,]/g,i=this.filters,a=i.name.toLowerCase().replace(e,"");for(var s in this.list){var n=this.list[s];t[n._id]=(-1!==n.name.toLowerCase().replace(e,"").indexOf(a)||n.hero&&-1!==n.hero.toLowerCase().replace(e,"").indexOf(a)||n.nicknames&&-1!==n.nicknames.join(",").toLowerCase().replace(r,"").indexOf(a))&&["role","rarity"].every((t=>!i[t].length||i[t].includes(n[t])))&&(!i.tags||i.tags.every((t=>n.tags.includes(t))))&&["common","buff","debuff"].every((t=>!i[t].length||i[t].every((e=>n[t]&&n[t].includes(e)))))}return t}},methods:{fetchComplete(t){const e=Date.now()-6048e5;this.list=t.map((t=>(e<t.created_dt?t.$isNew=!0:e<t.updated_dt&&(t.$isUpdated=!0),t)))},afterFetch(){this.$nextTick((()=>{this.mainContainerWrapper().scrollTo(0,_)}))}}};const W=(0,v.Z)(F,[["render",l]]);var L=W}}]);