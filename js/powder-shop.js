(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["powder-shop"],{"2fa3":function(t,e,i){"use strict";function n(t,e){var i=null;return function(){clearTimeout(i);var n=arguments,s=this;i=setTimeout((function(){t.apply(s,n)}),e)}}function s(t,e){var i=!1;return function(){i||(t.apply(this,arguments),i=!0,setTimeout((function(){i=!1}),e))}}i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return s}))},3878:function(t,e,i){"use strict";i.r(e);i("d3b7"),i("3ca3"),i("ddb0"),i("159b"),i("4de4"),i("a15b"),i("d81d"),i("cb29");var n=i("7d68"),s=i("2fa3"),o={};function r(t){o.start||(o.start=t.touches[0]||t.changedTouches[0])}function a(t){t.preventDefault()}function c(t){var e=t.touches[0]||t.changedTouches[0];if(o.start){if(o.start.clientX-e.clientX>50){var i=new CustomEvent("swipe-left",{bubbles:!0,cancelable:!1});t.target.dispatchEvent(i)}else if(o.start.clientX-e.clientX<-50){var n=new CustomEvent("swipe-right",{bubbles:!0,cancelable:!1});t.target.dispatchEvent(n)}else if(o.start.clientY-e.clientY>50){var s=new CustomEvent("swipe-down",{bubbles:!0,cancelable:!1});t.target.dispatchEvent(s)}else if(o.start.clientY-e.clientY<-50){var r=new CustomEvent("swipe-up",{bubbles:!0,cancelable:!1});t.target.dispatchEvent(r)}delete o.start}}var l,u,h={name:"powder-shop",components:{ctrlf:n["a"]},data:function(){return{shop:[],artifacts:null,slide:0,focused:null,observer:null,animationEnter:"slide-from-right",openShopList:!1}},computed:{mobile:function(){return this.$store.state.isMobile},saveDataMode:function(){return this.mobile}},watch:{slide:function(t,e){this.focused=null,this.animationEnter=e>t?"slide-from-right":"slide-from-left"}},beforeCreate:function(){this.$store.commit("loading",!0)},created:function(){var t=this;this.toggleLoading(!0),Promise.all([this.$store.dispatch("getPowderShop"),this.$store.dispatch("getArtifactDB")]).then((function(e){t.shop=e[0],t.artifacts=e[1],t.ready=!0,t.$nextTick((function(){t.toggleLoading(!1),t.createObserver();var e=document.getElementById("shop-slides");e.addEventListener("wheel",t.mousewheel,{passive:!0}),document.addEventListener("keydown",t.handleKeyDown,!1),e.addEventListener("touchstart",r,{passive:!0}),e.addEventListener("touchmove",a,{passive:!1}),e.addEventListener("touchend",c,{passive:!0})}))})).catch((function(t){return console.log(t)}))},beforeDestroy:function(){var t=this,e=document.getElementById("shop-slides");document.removeEventListener("keydown",this.handleKeyDown),e.removeEventListener("wheel",this.mousewheel),e.removeEventListener("touchstart",r),e.removeEventListener("touchmove",a),e.removeEventListener("touchend",c);var i=document.querySelectorAll("li");i.forEach((function(e){t.observer.unobserve(e)})),this.destroyObserver(),this.observer=null},mounted:function(){},beforeUpdate:function(){},updated:function(){},methods:{home:function(){this.$store.commit("toggleMainMenu")},toggleLoading:function(t,e){this.$store.commit("loading",t,e)},loading:function(){var t=this;return this.$store.commit("loading",!0),new Promise((function(e){setTimeout((function(){e(),t.$nextTick((function(){t.$store.commit("loading",!1)}))}),0)}))},artifact:function(t){return this.$store.getters.getArtifact(t)},getArtifactName:function(t){return this.$store.getters.getArtifactName(t)},getArtifactIcon:function(t){return this.$store.getters.getArtifactIcon(t)},getArtifactImage:function(t){return this.$store.getters.getArtifactImage(t)},getRarityIcon:function(t){return this.$store.getters.getRarityIcon(t)},getRoleIcon:function(t){return this.$store.getters.getRoleIcon(t)},toggleShopList:function(){this.openShopList=!this.openShopList},focusArtifact:function(t){this.focused!==t?this.focused=t:this.focused=null},searchFunction:function(t){var e=this,i=this.shop;if(!i.length||!t)return[];var n=t.toLowerCase();return i.filter((function(t){return!(!t.a||!Array.isArray(t.a))&&t.a.some((function(t){return-1!==e.$store.getters.getArtifactName(t.id).toLowerCase().indexOf(n)}))}))},searchToDisplay:function(t){return t.dt.join(" ~ ")},goToResult:function(t){var e=this;this.shop.forEach((function(i,n){i===t&&(e.slide=n)}))},mousewheel:Object(s["b"])((function(t){t.deltaY<0?this.slide>0&&(document.getElementById("shop-slides").scrollTop=(this.slide-1)*window.innerHeight):this.slide<this.shop.length&&(document.getElementById("shop-slides").scrollTop=(this.slide+1)*window.innerHeight)}),300),scrollSlide:function(){var t=this,e=document.body.scrollTop;window.requestAnimationFrame((function(){var i=document.body.scrollTop;e>=i?t.slide>0&&(window.scrollY=(t.slide-1)*window.innerHeight-10):t.slide<t.shop.length&&(window.scrollY=(t.slide+1)*window.innerHeight-10)}))},scrollBySwipe:function(t){t>0&&this.slide<this.shop.length?document.getElementById("shop-slides").scrollTop=(this.slide+1)*window.innerHeight:t<0&&this.slide>0&&(document.getElementById("shop-slides").scrollTop=(this.slide-1)*window.innerHeight)},handleKeyDown:Object(s["b"])((function(t){t.ctrlKey||"INPUT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&"true"!=t.target.contentEditable&&(t.preventDefault(),39===t.keyCode||"ArrowRight"===t.key||40===t.keyCode||"ArrowDown"===t.key||68===t.keyCode||"d"===t.key?this.scrollBySwipe(1):37!==t.keyCode&&"ArrowLeft"!==t.key&&38!==t.keyCode&&"ArrowUp"!==t.key&&65!==t.keyCode&&"a"!==t.key||this.scrollBySwipe(-1))}),300),scrollToSelected:function(t){document.getElementById("shop-slides").scrollTop=t*window.innerHeight},createObserver:function(){var t=this,e={root:null,rootMargin:"0px",threshold:.8};this.observer=new IntersectionObserver((function(e){e.forEach((function(e){var i=parseInt(e.target.attributes.index.value);e.isIntersecting&&(t.slide=i)}))}),e);var i=document.querySelectorAll("li");i.forEach((function(e){t.observer.observe(e)}))},destroyObserver:function(){this.observer&&this.observer.disconnect()}},render:function(t){var e=this;return t("section",{staticClass:"",attrs:{id:"shop-container"},style:{}},[t("floating-menu",{props:{mobile:this.mobile,options:[{title:"Search",class:"fa fa-search",click:"search"},{title:"Home",class:"fa fa-home",click:"home"}]},on:{home:function(){return e.home()},search:function(){return e.$refs.ctrlf.openSearchBar()}}}),t("ctrlf",{ref:"ctrlf",props:{events:this.shop,searchFunction:this.searchFunction,toDisplay:this.searchToDisplay},on:{event:this.goToResult}}),t("ul",{style:{width:"100%",height:"100%",overflow:"auto"},attrs:{id:"shop-slides"},on:{"swipe-left":function(){return e.scrollBySwipe(1)},"swipe-right":function(){return e.scrollBySwipe(-1)},"swipe-up":function(){return e.scrollBySwipe(-1)},"swipe-down":function(){return e.scrollBySwipe(1)}}},[this.shop[this.slide]?t("transition",{attrs:{name:this.animationEnter}},[t("div",{key:this.slide,staticClass:"powder-slide-rotations",style:{position:"absolute","z-index":1,top:0,left:0}},[t("div",{staticClass:"title-container"},[t("button",{staticClass:"fa rotation-list-btn",class:{"fa-list":!this.openShopList,"fa-times":this.openShopList},on:{click:function(){return e.toggleShopList()}}}),this.shop[this.slide].nid?t("a",{attrs:{target:"_blank",href:"https://page.onstove.com/epicseven/global/view/"+this.shop[this.slide].nid,crossorigin:"anonymous",SameSite:"Lax"},style:{float:"right",height:"100%",width:"110px","margin-right":"14px",background:"url(https://static-cdn.onstove.com/0.0.14/img/gnb/bi.svg) no-repeat scroll 0% 50%"},directives:[{name:"tooltip",value:"Read patch notice on stove."}]},[]):null,t("span",{style:{float:"left","padding-left":"10px"}},this.slide+1+"/"+this.shop.length),t("div",{style:{margin:"0 180px 0 55px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},this.shop[this.slide].dt.join(" ~ "))]),t("div",{staticClass:"rotation"},[this.saveDataMode?t("div",{style:{"align-self":"center",width:"100%","max-width":"450px"}},[this.shop[this.slide].a.map((function(i){var n=(window.innerHeight-100)/e.shop[e.slide].a.length+"px";return t("div",{style:{display:"flex",width:"100%","align-items":"center"}},[t("img",{attrs:{src:e.getArtifactIcon(i.id),crossorigin:"anonymous",SameSite:"Lax"},style:{height:n},directives:[{name:"tooltip",value:'<img height="200" src="'+e.getArtifactImage(i.id)+'">'}]}),t("img",{attrs:{src:e.getRoleIcon(e.artifact(i.id).role)},style:{height:"30px"}}),t("span",{style:{flex:1,margin:"0 20px"}},e.getArtifactName(i.id)),t("span",{style:{overflow:"hidden","white-space":"nowrap","padding-left":"8px"}},new Array(e.artifact(i.id).rarity||1).fill(t("img",{attrs:{src:e.getRarityIcon()},style:{height:"20px","margin-left":"-8px","vertical-align":"middle"}})))])}))]):this.shop[this.slide].a.map((function(i,n){return t("div",{staticClass:"artifact",class:{focused:e.focused===n},on:{click:function(){return e.focusArtifact(n)}},style:{}},[t("img",{staticClass:"artwork",style:{opacity:0},attrs:{crossorigin:"anonymous",SameSite:"Lax",src:e.getArtifactImage(i.id)},on:{load:function(t){return t.target.style.opacity=1}}}),t("span",{style:{"padding-left":"8px"}},new Array(e.artifact(i.id).rarity||1).fill(t("img",{attrs:{src:e.getRarityIcon(),SameSite:"Lax",crossorigin:"anonymous"},style:{height:"20px","margin-left":"-8px","vertical-align":"middle"}}))),t("span",{staticClass:"vertical-name"},e.getArtifactName(i.id))])})),this.shop[this.slide].content?t("div",{domProps:{innerHTML:this.shop[this.slide].content}}):null])])]):null,this.shop.map((function(e,i){return t("li",{staticClass:"powder-slide-rotations",style:{visibility:"hidden"},attrs:{index:i}},[t("div",{staticClass:"title-container"},"Data della rotazione"),t("div",{staticClass:"rotation"})])}))]),this.shop&&this.openShopList?t("div",{staticClass:"glass-container rotation-list-box"},[this.shop.map((function(i,n){return t("div",{staticClass:"elements",class:{active:e.slide===n},on:{click:function(){return e.scrollToSelected(n)}}},n+1+". "+i.dt[0])}))]):null])}},d=h,f=(i("eb71"),i("2877")),p=Object(f["a"])(d,l,u,!1,null,null,null);e["default"]=p.exports},"6d86":function(t,e,i){},"7d68":function(t,e,i){"use strict";i("d81d");var n,s,o=i("2fa3"),r={name:"ctrlf",props:{events:{type:Array,required:!1,default:function(){return[]}},renderBox:{type:Boolean,required:!1,default:!0},searchFunction:{type:Function,required:!0},toDisplay:{type:Function,required:!0}},data:function(){return{render:!1,current:0,results:[],hideResultsBox:!1}},computed:{mobile:function(){return!0}},created:function(){document.addEventListener("keydown",this.openCtrl,!0)},beforeDestroy:function(){document.removeEventListener("keydown",this.openCtrl,!0)},mounted:function(){},methods:{openCtrl:function(t){t.ctrlKey&&"f"===t.key&&(t.preventDefault(),this.render=!0,this.openSearchBar())},openSearchBar:function(){this.render=!0,this.focusInput(),this.selectInputContent()},focus:function(){this.focusInput(),this.selectInputContent()},focusInput:function(){var t=this;this.$nextTick((function(){t.$refs["input-search-box"].focus()}))},selectInputContent:function(){var t=this;this.$nextTick((function(){t.$refs["input-search-box"].select()}))},searchEvent:Object(o["a"])((function(t){this.results=this.searchFunction(t.target.value),this.current=0,this.clickEvent(this.results[this.current])}),300),goToSearchEvent:function(t){this.results.length&&(this.current=t,this.current<0&&(this.current=this.results.length-1),this.current>this.results.length-1&&(this.current=0),this.clickEvent(this.results[this.current]))},clickEvent:function(t){this.$emit("event",t)},closeSearchBar:function(){this.render=!1}},render:function(t){var e=this;return t("div",{staticClass:"search-box-pos",style:{display:this.render?"":"none"}},[t("div",{staticClass:"ch-search-box"},[t("input",{ref:"input-search-box",on:{input:function(t){return e.searchEvent(t)},keydown:function(t){("enter"===t.key||13===t.keyCode)&&e.goToSearchEvent(e.current+1)}}}),t("div",{},Math.min(this.current+1,this.results.length)+"/"+this.results.length),t("span",{staticClass:"fas fa-angle-up",on:{click:function(){return e.goToSearchEvent(e.current+1)}},class:{disabled:0===this.results.length}}),t("span",{staticClass:"fas fa-angle-down",on:{click:function(){return e.goToSearchEvent(e.current-1)}},class:{disabled:0===this.results.length}}),t("span",{staticClass:"fas fa-bars",on:{click:function(){return e.renderBox=!e.renderBox}}}),t("span",{staticClass:"fas fa-times",on:{click:function(){return e.closeSearchBar()}}})]),this.renderBox?t("div",{staticClass:"search-results-box",class:{hidebox:this.hideResultsBox}},this.results.map((function(i,n){return t("div",{staticClass:"item",class:{active:n===e.current},on:{click:function(){return e.goToSearchEvent(n)}}},e.toDisplay(i))}))):null])}},a=r,c=(i("9f9f"),i("2877")),l=Object(c["a"])(a,n,s,!1,null,null,null);e["a"]=l.exports},"81d5":function(t,e,i){"use strict";var n=i("7b0b"),s=i("23cb"),o=i("07fa");t.exports=function(t){var e=n(this),i=o(e),r=arguments.length,a=s(r>1?arguments[1]:void 0,i),c=r>2?arguments[2]:void 0,l=void 0===c?i:s(c,i);while(l>a)e[a++]=t;return e}},"9f9f":function(t,e,i){"use strict";i("bcfb")},bcfb:function(t,e,i){},cb29:function(t,e,i){var n=i("23e7"),s=i("81d5"),o=i("44d2");n({target:"Array",proto:!0},{fill:s}),o("fill")},eb71:function(t,e,i){"use strict";i("6d86")}}]);